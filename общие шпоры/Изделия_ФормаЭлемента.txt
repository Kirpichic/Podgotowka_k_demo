&НаСервере
Процедура ОткрытьФайлНаСервере()
	ДокументОбъект = РеквизитФормыВЗначение("Объект");
	ДанныеФайла = Новый ДвоичныеДанные(ПутьКФайлу);
	КоличествоСтрок = ДокументОбъект.Документация.Количество();
	ДокументОбъект.Документация.Добавить();
	ДокументОбъект.Документация[КоличествоСтрок].Файл = Новый ХранилищеЗначения(ДанныеФайла, Новый СжатиеДанных(9)); 
	ДокументОбъект.Документация[КоличествоСтрок].ИмяФайла = ИмяФайлаДиалог;
	ДокументОбъект.Документация[КоличествоСтрок].РасширениеФайла = РасширениеФайлаИзДиалога; 
	ДокументОбъект.Записать();
	ЗначениеВРеквизитФормы(ДокументОбъект, "Объект");
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФайл(Команда) 
	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Диалог.МножественныйВыбор = Ложь;
	
	Если Диалог.Выбрать() Тогда
		ПутьКФайлу = Диалог.ПолноеИмяФайла;
		ПозицияПоследнейТочки = СтрНайти(ПутьКФайлу,".",НаправлениеПоиска.СКонца,,1);
		ПозицияПоследнегоСлеша = СтрНайти(ПутьКФайлу,"\",НаправлениеПоиска.СКонца,,1);
		РасширениеФайлаИзДиалога = Прав(ПутьКФайлу,СтрДлина(ПутьКФайлу)-ПозицияПоследнейТочки);
		ИмяФайлаДиалог = Сред(ПутьКФайлу,ПозицияПоследнегоСлеша+1,ПозицияПоследнейТочки-ПозицияПоследнегоСлеша-1);    
	КонецЕсли;    
	
	Если Не ПутьКФайлу = ""  Тогда	
		ОткрытьФайлНаСервере();
		Элементы.ДокументацияЗагруизитьФайл.Доступность = Истина;
	Иначе
	    Сообщить("Файл не выбран!!!")		
	КонецЕсли;                    
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	Если Объект.Документация.Количество() > 0 Тогда
		Элементы.ДокументацияЗагрузитьФайл.Доступность = Истина;
	Иначе
		Элементы.ДокументацияЗагрузитьФайл.Доступность = Ложь;
	КонецЕсли;
КонецПроцедуры


&НаСервере
Процедура ЗагрузитьФайлНаСервере(НомерСтроки)
	ДокументОбъект = РеквизитФормыВЗначение("Объект");
	Путь =  ПолучитьИмяВременногоФайла(ДокументОбъект.Документация[НомерСтроки-1].РасширениеФайла);
	Данные = ДокументОбъект.Документация[НомерСтроки-1].Файл.Получить();
	Данные.Записать(Путь); 
	ЗапуститьПриложение(Путь);
	ЗначениеВРеквизитФормы(ДокументОбъект,"Объект");
КонецПроцедуры


&НаКлиенте
Процедура ЗагрузитьФайл(Команда)
	НомерТекущейСтроки = Элементы.Документация.ТекущиеДанные.НомерСтроки;
	ЗагрузитьФайлНаСервере(НомерТекущейСтроки);
КонецПроцедуры
