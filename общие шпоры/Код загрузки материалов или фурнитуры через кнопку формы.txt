//Для материалов
&НаСервере
Процедура ЗагрузкаДанныхНаСервере(Результат, ДопПараметр)
	Если НЕ(Результат = Неопределено) Тогда
		СсылкаНаФайл = Результат[0];
	Иначе
		Сообщить("Файл не выбран");
		Возврат;
	КонецЕсли;
	
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.Прочитать(СсылкаНаФайл);
	
	Для Строка = 2 По ТабДок.ВысотаТаблицы Цикл
		ЭлементМатериала = Справочники.Материалы.СоздатьЭлемент();
		
		ЭлементМатериала.Наименование = ТабДок.Область(Строка, 2).Текст;
		ЭлементМатериала.Артикул = ТабДок.Область(Строка, 1).Текст;
		ЭлементМатериала.Количество = ТабДок.Область(Строка, 5).Текст;   
		ЭлементМатериала.Цена = ТабДок.Область(Строка, 7).Текст;
		ЭлементМатериала.Ширина = ТабДок.Область(Строка, 4).Текст;
		
		ЕдинИзмерТабл = ТабДок.Область(Строка, 3).Текст;
		Если Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдинИзмерТабл, Истина) = Справочники.ЕдиницыИзмерения.ПустаяСсылка() Тогда
			ЭлементЕдИзм = Справочники.ЕдиницыИзмерения.СоздатьЭлемент();
			ЭлементЕдИзм.Наименование = ЕдинИзмерТабл;
			ЭлементЕдИзм.Записать();
			Сообщить("В справочник Единици измерения добавлена запись " + ЭлементЕдИзм.Наименование);
		КонецЕсли;
		ЭлементМатериала.ЕдиницаИзмерения = Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдинИзмерТабл, Истина); 
		
		ТипМатТабл = ТабДок.Область(Строка, 6).Текст;
		Если Справочники.ТипМатериала.НайтиПоНаименованию(ТипМатТабл, Истина) = Справочники.ТипМатериала.ПустаяСсылка() Тогда
			ЭлементТипМ = Справочники.ТипМатериала.СоздатьЭлемент();
			ЭлементТипМ.Наименование = ТипМатТабл;
			ЭлементТипМ.Записать();
			Сообщить("В справочник Тип материала добавлена запись " + ЭлементТипМ.Наименование);
		КонецЕсли;
		ЭлементМатериала.ТипМатериала = Справочники.ТипМатериала.НайтиПоНаименованию(ТипМатТабл, Истина);
		
		ЭлементМатериала.Записать();
		Сообщить("В справочник добавлена запись " + ЭлементМатериала.Наименование);		
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаДанных(Команда)
	ВыборФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор = Ложь;    
	ВыборФайла.Фильтр = "Табличные документы *.xlsx | *.xlsx";
	ВыборФайла.Показать(Новый ОписаниеОповещения("ЗагрузкаДанныхНаСервере", ЭтотОбъект, Новый Структура));
КонецПроцедуры


//Для фурнитуры
&НаСервере
Процедура ЗагрузкаДанныхНаСервере(Результат, ДопПараметр)
	Если НЕ(Результат = Неопределено) Тогда
		СсылкаНаФайл = Результат[0];
	Иначе
		Сообщить("Файл не выбран");
		Возврат;
	КонецЕсли;
	
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.Прочитать(СсылкаНаФайл);
	
	Для Строка = 2 По ТабДок.ВысотаТаблицы Цикл
		Элементфурнитуры = Справочники.Фурнитура.СоздатьЭлемент();
		
		Элементфурнитуры.Наименование = ТабДок.Область(Строка, 2).Текст;
		Элементфурнитуры.Артикул = ТабДок.Область(Строка, 1).Текст;
		Элементфурнитуры.Количество = ТабДок.Область(Строка, 3).Текст;   
		Элементфурнитуры.Цена = ТабДок.Область(Строка, 6).Текст;
		
		ЕдинИзмерТабл = ТабДок.Область(Строка, 4).Текст;
		Если Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдинИзмерТабл, Истина) = Справочники.ЕдиницыИзмерения.ПустаяСсылка() Тогда
			ЭлементЕдИзм = Справочники.ЕдиницыИзмерения.СоздатьЭлемент();
			ЭлементЕдИзм.Наименование = ЕдинИзмерТабл;
			ЭлементЕдИзм.Записать();
			Сообщить("В справочник Единици измерения добавлена запись " + ЭлементЕдИзм.Наименование);
		КонецЕсли;
		Элементфурнитуры.ЕдиницаИзмерения = Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдинИзмерТабл, Истина); 
		
		ТипФурТабл = ТабДок.Область(Строка, 5).Текст;
		Если Справочники.ТипФурнитуры.НайтиПоНаименованию(ТипФурТабл, Истина) = Справочники.ТипФурнитуры.ПустаяСсылка() Тогда
			ЭлементТипФ = Справочники.ТипФурнитуры.СоздатьЭлемент();
			ЭлементТипФ.Наименование = ТипФурТабл;
			ЭлементТипФ.Записать();
			Сообщить("В справочник Тип фурнитуры добавлена запись " + ЭлементТипФ.Наименование);
		КонецЕсли;
		Элементфурнитуры.ТипФурнитуры = Справочники.ТипФурнитуры.НайтиПоНаименованию(ТипФурТабл, Истина);
		
		Элементфурнитуры.Записать();
		Сообщить("В справочник добавлена запись " + Элементфурнитуры.Наименование);		
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаДанных(Команда)
	ВыборФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор = Ложь;    
	ВыборФайла.Фильтр = "Табличные документы *.xlsx | *.xlsx";
	ВыборФайла.Показать(Новый ОписаниеОповещения("ЗагрузкаДанныхНаСервере", ЭтотОбъект, Новый Структура));
КонецПроцедуры

